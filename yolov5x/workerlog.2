grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "tools/train.py", line 33, in <module>
    from ppdet.core.workspace import load_config, merge_config
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/__init__.py", line 15, in <module>
    from . import (core, data, engine, modeling, model_zoo, optimizer, metrics,
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/__init__.py", line 15, in <module>
    from . import source
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/source/__init__.py", line 15, in <module>
    from . import coco
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/source/coco.py", line 132
    <<<<<<< HEAD
    ^
IndentationError: expected an indented block
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "tools/train.py", line 33, in <module>
    from ppdet.core.workspace import load_config, merge_config
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/__init__.py", line 15, in <module>
    from . import (core, data, engine, modeling, model_zoo, optimizer, metrics,
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/__init__.py", line 15, in <module>
    from . import source
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/source/__init__.py", line 15, in <module>
    from . import coco
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/source/coco.py", line 17, in <module>
    from ppdet.core.workspace import register, serializable
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/core/workspace.py", line 152
    <<<<<<< HEAD
     ^
SyntaxError: invalid syntax
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "tools/train.py", line 33, in <module>
    from ppdet.core.workspace import load_config, merge_config
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/__init__.py", line 15, in <module>
    from . import (core, data, engine, modeling, model_zoo, optimizer, metrics,
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/__init__.py", line 15, in <module>
    from . import source
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/source/__init__.py", line 15, in <module>
    from . import coco
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/source/coco.py", line 18, in <module>
    from .dataset import DetDataset
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/source/dataset.py", line 118
    <<<<<<< HEAD
     ^
SyntaxError: invalid syntax
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "tools/train.py", line 33, in <module>
    from ppdet.core.workspace import load_config, merge_config
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/__init__.py", line 15, in <module>
    from . import (core, data, engine, modeling, model_zoo, optimizer, metrics,
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/__init__.py", line 15, in <module>
    from . import source
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/source/__init__.py", line 15, in <module>
    from . import coco
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/source/coco.py", line 18, in <module>
    from .dataset import DetDataset
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/source/dataset.py", line 24, in <module>
    from ppdet.utils.download import get_dataset_path
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/utils/download.py", line 28
    <<<<<<< HEAD
     ^
SyntaxError: invalid syntax
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "tools/train.py", line 33, in <module>
    from ppdet.core.workspace import load_config, merge_config
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/__init__.py", line 15, in <module>
    from . import (core, data, engine, modeling, model_zoo, optimizer, metrics,
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/__init__.py", line 16, in <module>
    from . import transform
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/__init__.py", line 15, in <module>
    from . import operators
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/operators.py", line 41, in <module>
    from ppdet.modeling import bbox_utils
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/__init__.py", line 19, in <module>
    from . import ops
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/ops.py", line 56
    <<<<<<< HEAD
    ^
IndentationError: expected an indented block
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "tools/train.py", line 33, in <module>
    from ppdet.core.workspace import load_config, merge_config
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/__init__.py", line 15, in <module>
    from . import (core, data, engine, modeling, model_zoo, optimizer, metrics,
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/__init__.py", line 16, in <module>
    from . import transform
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/__init__.py", line 15, in <module>
    from . import operators
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/operators.py", line 41, in <module>
    from ppdet.modeling import bbox_utils
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/__init__.py", line 20, in <module>
    from . import backbones
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/backbones/__init__.py", line 19, in <module>
    from . import mobilenet_v3
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/backbones/mobilenet_v3.py", line 26
    <<<<<<< HEAD
     ^
SyntaxError: invalid syntax
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "tools/train.py", line 33, in <module>
    from ppdet.core.workspace import load_config, merge_config
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/__init__.py", line 15, in <module>
    from . import (core, data, engine, modeling, model_zoo, optimizer, metrics,
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/__init__.py", line 16, in <module>
    from . import transform
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/__init__.py", line 15, in <module>
    from . import operators
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/operators.py", line 41, in <module>
    from ppdet.modeling import bbox_utils
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/__init__.py", line 20, in <module>
    from . import backbones
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/backbones/__init__.py", line 19, in <module>
    from . import mobilenet_v3
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/backbones/mobilenet_v3.py", line 150
    =======
     ^
SyntaxError: invalid syntax
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "tools/train.py", line 33, in <module>
    from ppdet.core.workspace import load_config, merge_config
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/__init__.py", line 15, in <module>
    from . import (core, data, engine, modeling, model_zoo, optimizer, metrics,
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/__init__.py", line 16, in <module>
    from . import transform
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/__init__.py", line 15, in <module>
    from . import operators
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/operators.py", line 41, in <module>
    from ppdet.modeling import bbox_utils
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/__init__.py", line 20, in <module>
    from . import backbones
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/backbones/__init__.py", line 19, in <module>
    from . import mobilenet_v3
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/backbones/mobilenet_v3.py", line 61
    >>>>>>> 879c90b6d0420410973f5e22932417d174ef45a9
     ^
SyntaxError: invalid syntax
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "tools/train.py", line 33, in <module>
    from ppdet.core.workspace import load_config, merge_config
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/__init__.py", line 15, in <module>
    from . import (core, data, engine, modeling, model_zoo, optimizer, metrics,
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/__init__.py", line 16, in <module>
    from . import transform
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/__init__.py", line 15, in <module>
    from . import operators
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/operators.py", line 41, in <module>
    from ppdet.modeling import bbox_utils
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/__init__.py", line 20, in <module>
    from . import backbones
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/backbones/__init__.py", line 28, in <module>
    from . import cspdarknet
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/backbones/cspdarknet.py", line 3
    from __future__ import absolute_import
    ^
SyntaxError: from __future__ imports must occur at the beginning of the file
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "tools/train.py", line 33, in <module>
    from ppdet.core.workspace import load_config, merge_config
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/__init__.py", line 15, in <module>
    from . import (core, data, engine, modeling, model_zoo, optimizer, metrics,
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/__init__.py", line 16, in <module>
    from . import transform
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/__init__.py", line 15, in <module>
    from . import operators
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/operators.py", line 41, in <module>
    from ppdet.modeling import bbox_utils
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/__init__.py", line 20, in <module>
    from . import backbones
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/backbones/__init__.py", line 28, in <module>
    from . import cspdarknet
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/backbones/cspdarknet.py", line 10, in <module>
    from ..architectures.common import parse_model
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/architectures/__init__.py", line 16, in <module>
    from . import ttfnet
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/architectures/ttfnet.py", line 50
    <<<<<<< HEAD
     ^
SyntaxError: invalid syntax
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
Traceback (most recent call last):
  File "tools/train.py", line 33, in <module>
    from ppdet.core.workspace import load_config, merge_config
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/__init__.py", line 15, in <module>
    from . import (core, data, engine, modeling, model_zoo, optimizer, metrics,
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/__init__.py", line 16, in <module>
    from . import transform
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/__init__.py", line 15, in <module>
    from . import operators
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/operators.py", line 41, in <module>
    from ppdet.modeling import bbox_utils
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/__init__.py", line 20, in <module>
    from . import backbones
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/backbones/__init__.py", line 28, in <module>
    from . import cspdarknet
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/backbones/cspdarknet.py", line 10, in <module>
    from ..architectures.common import parse_model
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/architectures/__init__.py", line 20, in <module>
    from . import jde
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/architectures/jde.py", line 20, in <module>
    from ppdet.modeling.mot.utils import scale_coords
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/mot/__init__.py", line 15, in <module>
    from . import matching
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/mot/matching/__init__.py", line 15, in <module>
    from . import jde_matching
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/mot/matching/jde_matching.py", line 18, in <module>
    import lap
ModuleNotFoundError: No module named 'lap'
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/paddle/tensor/creation.py:125: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:
Traceback (most recent call last):
  File "tools/train.py", line 33, in <module>
    from ppdet.core.workspace import load_config, merge_config
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/__init__.py", line 15, in <module>
    from . import (core, data, engine, modeling, model_zoo, optimizer, metrics,
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/__init__.py", line 16, in <module>
    from . import transform
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/__init__.py", line 15, in <module>
    from . import operators
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/operators.py", line 41, in <module>
    from ppdet.modeling import bbox_utils
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/__init__.py", line 23, in <module>
    from . import heads
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/heads/__init__.py", line 27, in <module>
    from . import centernet_head
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/heads/centernet_head.py", line 21, in <module>
    from ppdet.modeling.losses import CTFocalLoss
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/losses/__init__.py", line 16, in <module>
    from . import iou_aware_loss
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/losses/iou_aware_loss.py", line 21, in <module>
    from .iou_loss import IouLoss
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/losses/iou_loss.py", line 199
    <<<<<<< HEAD
     ^
SyntaxError: invalid syntax
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/paddle/tensor/creation.py:125: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:
Traceback (most recent call last):
  File "tools/train.py", line 33, in <module>
    from ppdet.core.workspace import load_config, merge_config
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/__init__.py", line 15, in <module>
    from . import (core, data, engine, modeling, model_zoo, optimizer, metrics,
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/__init__.py", line 16, in <module>
    from . import transform
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/__init__.py", line 15, in <module>
    from . import operators
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/operators.py", line 41, in <module>
    from ppdet.modeling import bbox_utils
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/__init__.py", line 23, in <module>
    from . import heads
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/heads/__init__.py", line 27, in <module>
    from . import centernet_head
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/heads/centernet_head.py", line 21, in <module>
    from ppdet.modeling.losses import CTFocalLoss
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/losses/__init__.py", line 19, in <module>
    from . import fcos_loss
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/modeling/losses/fcos_loss.py", line 80
    <<<<<<< HEAD
     ^
SyntaxError: invalid syntax
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/paddle/tensor/creation.py:125: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:
Traceback (most recent call last):
  File "tools/train.py", line 33, in <module>
    from ppdet.core.workspace import load_config, merge_config
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/__init__.py", line 15, in <module>
    from . import (core, data, engine, modeling, model_zoo, optimizer, metrics,
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/__init__.py", line 16, in <module>
    from . import transform
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/__init__.py", line 15, in <module>
    from . import operators
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/transform/operators.py", line 42, in <module>
    from ..reader import Compose
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/reader.py", line 171
    <<<<<<< HEAD
     ^
SyntaxError: invalid syntax
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/paddle/tensor/creation.py:125: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:
Warning: import ppdet from source directory without installing, run 'python setup.py install' to install ppdet firstly
Traceback (most recent call last):
  File "tools/train.py", line 139, in <module>
    main()
  File "tools/train.py", line 115, in main
    cfg = load_config(FLAGS.config)
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/core/workspace.py", line 112, in load_config
    cfg = _load_config_with_base(file_path)
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/core/workspace.py", line 92, in _load_config_with_base
    base_cfg = _load_config_with_base(base_yml)
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/core/workspace.py", line 79, in _load_config_with_base
    file_cfg = yaml.load(f, Loader=yaml.Loader)
  File "/usr/local/lib/python3.7/dist-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/lib/python3.7/dist-packages/yaml/constructor.py", line 51, in get_single_data
    return self.construct_document(node)
  File "/usr/local/lib/python3.7/dist-packages/yaml/constructor.py", line 60, in construct_document
    for dummy in generator:
  File "/usr/local/lib/python3.7/dist-packages/yaml/constructor.py", line 408, in construct_yaml_seq
    data.extend(self.construct_sequence(node))
  File "/usr/local/lib/python3.7/dist-packages/yaml/constructor.py", line 130, in construct_sequence
    for child in node.value]
  File "/usr/local/lib/python3.7/dist-packages/yaml/constructor.py", line 130, in <listcomp>
    for child in node.value]
  File "/usr/local/lib/python3.7/dist-packages/yaml/constructor.py", line 100, in construct_object
    data = constructor(self, node)
  File "/usr/local/lib/python3.7/dist-packages/yaml/constructor.py", line 429, in construct_undefined
    node.start_mark)
yaml.constructor.ConstructorError: could not determine a constructor for the tag '!OneCycle'
  in "configs/yolov5/_base_/optimizer.yml", line 6, column 7
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/paddle/tensor/creation.py:125: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:
Warning: import ppdet from source directory without installing, run 'python setup.py install' to install ppdet firstly
I0809 03:45:28.524639  8759 gen_comm_id_helper.cc:181] Server listening on: 127.0.0.1:30252 successful.
I0809 03:45:29.175793  8759 nccl_context.cc:74] init nccl context nranks: 4 local rank: 2 gpu id: 2 ring id: 0
W0809 03:45:30.171025  8759 device_context.cc:404] Please NOTE: device: 2, GPU Compute Capability: 7.0, Driver API Version: 11.2, Runtime API Version: 11.2
W0809 03:45:30.179176  8759 device_context.cc:422] device: 2, cuDNN Version: 8.1.
loading annotations into memory...
Done (t=3.66s)
creating index...
index created!
--------steps_per_epoch--------
97
Config dataset_dir ../../dataset/coco is not exits, dataset config is not valid
WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

Traceback (most recent call last):
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 236, in _feed
    obj = _ForkingPickler.dumps(obj)
  File "/usr/lib/python3.7/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
MemoryError
Traceback (most recent call last):
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 236, in _feed
    obj = _ForkingPickler.dumps(obj)
  File "/usr/lib/python3.7/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
MemoryError
ERROR:root:DataLoader reader thread raised an exception!
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.7/threading.py", line 926, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.7/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 411, in _thread_loop
    batch = self._get_data()
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 525, in _get_data
    batch.reraise()
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/worker.py", line 168, in reraise
    raise self.exc_type(msg)
TypeError: __init__() missing 1 required positional argument: 'dtype'

Traceback (most recent call last):
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 236, in _feed
    obj = _ForkingPickler.dumps(obj)
  File "/usr/lib/python3.7/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
MemoryError
Traceback (most recent call last):
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 236, in _feed
    obj = _ForkingPickler.dumps(obj)
  File "/usr/lib/python3.7/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
OverflowError: cannot serialize a bytes object larger than 4 GiB
Traceback (most recent call last):
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 236, in _feed
    obj = _ForkingPickler.dumps(obj)
  File "/usr/lib/python3.7/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
OverflowError: cannot serialize a bytes object larger than 4 GiB


--------------------------------------
C++ Traceback (most recent call last):
--------------------------------------
0   paddle::framework::SignalHandle(char const*, int)
1   paddle::platform::GetCurrentTraceBackString[abi:cxx11]()

----------------------
Error Message Summary:
----------------------
FatalError: `Termination signal` is detected by the operating system.
  [TimeInfo: *** Aborted at 1628480818 (unix time) try "date -d @1628480818" if you are using GNU date ***]
  [SignalInfo: *** SIGTERM (@0x21f0) received by PID 8759 (TID 0x7f2813bd5740) from PID 8688 ***]

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/paddle/tensor/creation.py:125: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:
Warning: import ppdet from source directory without installing, run 'python setup.py install' to install ppdet firstly
I0809 03:49:33.538551 10324 gen_comm_id_helper.cc:181] Server listening on: 127.0.0.1:47749 successful.
I0809 03:49:34.111047 10324 nccl_context.cc:74] init nccl context nranks: 4 local rank: 2 gpu id: 2 ring id: 0
W0809 03:49:35.270437 10324 device_context.cc:404] Please NOTE: device: 2, GPU Compute Capability: 7.0, Driver API Version: 11.2, Runtime API Version: 11.2
W0809 03:49:35.285434 10324 device_context.cc:422] device: 2, cuDNN Version: 8.1.
loading annotations into memory...
Done (t=3.72s)
creating index...
index created!
Shared memory size is less than 1G, disable shared_memory in DataLoader
--------steps_per_epoch--------
97
Config dataset_dir ../../dataset/coco is not exits, dataset config is not valid
WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

ERROR:root:DataLoader reader thread raised an exception!
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.7/threading.py", line 926, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.7/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 411, in _thread_loop
    batch = self._get_data()
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 525, in _get_data
    batch.reraise()
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/worker.py", line 168, in reraise
    raise self.exc_type(msg)
TypeError: __init__() missing 1 required positional argument: 'dtype'

Traceback (most recent call last):
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 236, in _feed
    obj = _ForkingPickler.dumps(obj)
  File "/usr/lib/python3.7/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
MemoryError
Traceback (most recent call last):
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 236, in _feed
    obj = _ForkingPickler.dumps(obj)
  File "/usr/lib/python3.7/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
MemoryError
Traceback (most recent call last):
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 236, in _feed
    obj = _ForkingPickler.dumps(obj)
  File "/usr/lib/python3.7/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
OverflowError: cannot serialize a bytes object larger than 4 GiB


--------------------------------------
C++ Traceback (most recent call last):
--------------------------------------
0   paddle::framework::SignalHandle(char const*, int)
1   paddle::platform::GetCurrentTraceBackString[abi:cxx11]()

----------------------
Error Message Summary:
----------------------
FatalError: `Termination signal` is detected by the operating system.
  [TimeInfo: *** Aborted at 1628481032 (unix time) try "date -d @1628481032" if you are using GNU date ***]
  [SignalInfo: *** SIGTERM (@0x280d) received by PID 10324 (TID 0x7ffb11f40740) from PID 10253 ***]

Traceback (most recent call last):
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 236, in _feed
    obj = _ForkingPickler.dumps(obj)
  File "/usr/lib/python3.7/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
OverflowError: cannot serialize a bytes object larger than 4 GiB
Traceback (most recent call last):
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 236, in _feed
    obj = _ForkingPickler.dumps(obj)
  File "/usr/lib/python3.7/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
OverflowError: cannot serialize a bytes object larger than 4 GiB
grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/paddle/tensor/creation.py:125: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:
Warning: import ppdet from source directory without installing, run 'python setup.py install' to install ppdet firstly
I0809 03:51:11.721460 11862 gen_comm_id_helper.cc:181] Server listening on: 127.0.0.1:48867 successful.
I0809 03:51:12.213539 11862 nccl_context.cc:74] init nccl context nranks: 4 local rank: 2 gpu id: 2 ring id: 0
W0809 03:51:13.223824 11862 device_context.cc:404] Please NOTE: device: 2, GPU Compute Capability: 7.0, Driver API Version: 11.2, Runtime API Version: 11.2
W0809 03:51:13.231845 11862 device_context.cc:422] device: 2, cuDNN Version: 8.1.
loading annotations into memory...
Done (t=3.73s)
creating index...
index created!
--------steps_per_epoch--------
97
Config dataset_dir ../../dataset/coco is not exits, dataset config is not valid
WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

Traceback (most recent call last):
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 236, in _feed
    obj = _ForkingPickler.dumps(obj)
  File "/usr/lib/python3.7/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
MemoryError
Process Process-8:
Traceback (most recent call last):
  File "/usr/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
  File "/usr/lib/python3.7/multiprocessing/process.py", line 99, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/worker.py", line 346, in _worker_loop
    six.reraise(*sys.exc_info())
  File "/usr/local/lib/python3.7/dist-packages/six.py", line 719, in reraise
    raise value
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/worker.py", line 341, in _worker_loop
    out_queue.put((idx, batch, structure))
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 87, in put
    self._start_thread()
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 170, in _start_thread
    self._thread.start()
  File "/usr/lib/python3.7/threading.py", line 852, in start
    _start_new_thread(self._bootstrap, ())
RuntimeError: can't start new thread
ERROR:root:DataLoader reader thread raised an exception!
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.7/threading.py", line 926, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.7/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 411, in _thread_loop
    batch = self._get_data()
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 525, in _get_data
    batch.reraise()
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/worker.py", line 168, in reraise
    raise self.exc_type(msg)
TypeError: __init__() missing 1 required positional argument: 'dtype'

Traceback (most recent call last):
  File "tools/train.py", line 139, in <module>
    main()
  File "tools/train.py", line 135, in main
    run(FLAGS, cfg)
  File "tools/train.py", line 110, in run
    trainer.train(FLAGS.eval)
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/engine/trainer.py", line 257, in train
    self._init_metrics(validate=validate)
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/engine/trainer.py", line 166, in _init_metrics
    eval_dataset.check_or_download_dataset()
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/source/dataset.py", line 90, in check_or_download_dataset
    self.image_dir)
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/utils/download.py", line 213, in get_dataset_path
    get_path(url, data_dir, md5sum, check_exist)
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/utils/download.py", line 288, in get_path
    fullname = _download_dist(url, root_dir, md5sum)
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/utils/download.py", line 413, in _download_dist
    time.sleep(0.5)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/multiprocess_utils.py", line 138, in __handler__
    core._throw_error_if_process_failed()
SystemError: (Fatal) DataLoader process (pid 12293) exited unexpectedly with code 1. Error detailed are lost due to multiprocessing. Rerunning with:
  1. If run DataLoader by DataLoader.from_generator(...), run with DataLoader.from_generator(..., use_multiprocess=False) may give better error trace.
  2. If run DataLoader by DataLoader(dataset, ...), run with DataLoader(dataset, ..., num_workers=0) may give better error trace (at /paddle/paddle/fluid/imperative/data_loader.cc:156)

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/paddle/tensor/creation.py:125: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:
Warning: import ppdet from source directory without installing, run 'python setup.py install' to install ppdet firstly
I0809 03:59:08.792863 13852 gen_comm_id_helper.cc:181] Server listening on: 127.0.0.1:58108 successful.
I0809 03:59:09.155835 13852 nccl_context.cc:74] init nccl context nranks: 4 local rank: 2 gpu id: 2 ring id: 0
W0809 03:59:10.368260 13852 device_context.cc:404] Please NOTE: device: 2, GPU Compute Capability: 7.0, Driver API Version: 11.2, Runtime API Version: 11.2
W0809 03:59:10.375063 13852 device_context.cc:422] device: 2, cuDNN Version: 8.1.
loading annotations into memory...
Done (t=3.53s)
creating index...
index created!
--------steps_per_epoch--------
97
Config dataset_dir ../../dataset/coco is not exits, dataset config is not valid
WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

WARNING:root:DataLoader reader thread raised an exception.
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.7/threading.py", line 926, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.7/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 199, in _thread_loop
    six.reraise(*sys.exc_info())
  File "/usr/local/lib/python3.7/dist-packages/six.py", line 719, in reraise
    raise value
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 167, in _thread_loop
    batch = self._dataset_fetcher.fetch(indices)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/fetcher.py", line 109, in fetch
    data = self.collate_fn(data)
  File "/home/codes/train_yolov5/PaddleDetection/ppdet/data/reader.py", line 91, in __call__
    batch_data = default_collate_fn(data)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/collate.py", line 70, in default_collate_fn
    for key in sample
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/collate.py", line 70, in <dictcomp>
    for key in sample
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/collate.py", line 58, in default_collate_fn
    batch = np.stack(batch, axis=0)
  File "<__array_function__ internals>", line 6, in stack
  File "/usr/local/lib/python3.7/dist-packages/numpy/core/shape_base.py", line 433, in stack
    return _nx.concatenate(expanded_arrays, axis=axis, out=out)
  File "<__array_function__ internals>", line 6, in concatenate
numpy.core._exceptions._ArrayMemoryError: Unable to allocate 2.92 GiB for an array with shape (64, 30, 3, 85, 40, 40) and data type float32

grep: warning: GREP_OPTIONS is deprecated; please use an alias or script
/usr/local/lib/python3.7/dist-packages/paddle/tensor/creation.py:125: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:
Warning: import ppdet from source directory without installing, run 'python setup.py install' to install ppdet firstly
I0809 04:03:25.222716 14247 gen_comm_id_helper.cc:181] Server listening on: 127.0.0.1:29261 successful.
I0809 04:03:25.451058 14247 nccl_context.cc:74] init nccl context nranks: 4 local rank: 2 gpu id: 2 ring id: 0
W0809 04:03:26.498591 14247 device_context.cc:404] Please NOTE: device: 2, GPU Compute Capability: 7.0, Driver API Version: 11.2, Runtime API Version: 11.2
W0809 04:03:26.505559 14247 device_context.cc:422] device: 2, cuDNN Version: 8.1.
loading annotations into memory...
Done (t=3.68s)
creating index...
index created!
--------steps_per_epoch--------
97
Config dataset_dir ../../dataset/coco is not exits, dataset config is not valid
  0%|          | 0/18883655 [00:00<?, ?KB/s]  0%|          | 3/18883655 [00:00<218:22:55, 24.02KB/s]  0%|          | 21/18883655 [00:00<147:36:31, 35.54KB/s]  0%|          | 42/18883655 [00:00<95:01:22, 55.20KB/s]   0%|          | 48/18883655 [00:01<164:41:24, 31.85KB/s]  0%|          | 59/18883655 [00:01<141:36:22, 37.04KB/s]  0%|          | 64/18883655 [00:02<206:40:40, 25.38KB/s]  0%|          | 73/18883655 [00:02<273:41:38, 19.17KB/s]  0%|          | 82/18883655 [00:02<231:48:30, 22.63KB/s]  0%|          | 85/18883655 [00:03<380:00:48, 13.80KB/s]  0%|          | 90/18883655 [00:03<332:05:43, 15.79KB/s]  0%|          | 93/18883655 [00:04<346:32:06, 15.14KB/s]  0%|          | 96/18883655 [00:04<360:18:52, 14.56KB/s]  0%|          | 100/18883655 [00:04<347:46:59, 15.08KB/s]  0%|          | 104/18883655 [00:04<338:17:56, 15.51KB/s]  0%|          | 110/18883655 [00:05<290:03:41, 18.08KB/s]WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

  0%|          | 112/18883655 [00:05<434:43:00, 12.07KB/s]  0%|          | 124/18883655 [00:05<248:28:05, 21.11KB/s]  0%|          | 129/18883655 [00:06<249:03:38, 21.06KB/s]  0%|          | 136/18883655 [00:06<225:42:58, 23.24KB/s]  0%|          | 143/18883655 [00:06<210:39:34, 24.90KB/s]  0%|          | 146/18883655 [00:06<265:50:15, 19.73KB/s]  0%|          | 154/18883655 [00:07<223:36:57, 23.46KB/s]  0%|          | 157/18883655 [00:07<328:39:25, 15.96KB/s]  0%|          | 166/18883655 [00:07<248:26:02, 21.11KB/s]  0%|          | 169/18883655 [00:08<276:56:53, 18.94KB/s]  0%|          | 173/18883655 [00:08<285:53:57, 18.35KB/s]  0%|          | 177/18883655 [00:08<292:58:23, 17.90KB/s]  0%|          | 181/18883655 [00:08<298:29:38, 17.57KB/s]  0%|          | 188/18883655 [00:09<250:33:57, 20.93KB/s]WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

  0%|          | 192/18883655 [00:09<331:18:27, 15.83KB/s]  0%|          | 203/18883655 [00:09<224:18:32, 23.38KB/s]ERROR:root:DataLoader reader thread raised an exception!
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.7/threading.py", line 926, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.7/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 411, in _thread_loop
    batch = self._get_data()
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/dataloader_iter.py", line 525, in _get_data
    batch.reraise()
  File "/usr/local/lib/python3.7/dist-packages/paddle/fluid/dataloader/worker.py", line 168, in reraise
    raise self.exc_type(msg)
TypeError: __init__() missing 1 required positional argument: 'dtype'

  0%|          | 209/18883655 [00:09<220:02:54, 23.84KB/s]  0%|          | 212/18883655 [00:10<321:52:37, 16.30KB/s]  0%|          | 220/18883655 [00:10<258:04:02, 20.33KB/s]  0%|          | 226/18883655 [00:10<243:42:06, 21.52KB/s]  0%|          | 231/18883655 [00:11<245:34:20, 21.36KB/s]  0%|          | 238/18883655 [00:11<222:57:47, 23.53KB/s]  0%|          | 245/18883655 [00:11<276:27:26, 18.97KB/s]  0%|          | 252/18883655 [00:12<245:26:35, 21.37KB/s]  0%|          | 258/18883655 [00:12<235:14:06, 22.30KB/s]  0%|          | 263/18883655 [00:12<239:06:32, 21.94KB/s]  0%|          | 270/18883655 [00:12<219:05:18, 23.94KB/s]  0%|          | 277/18883655 [00:13<206:13:06, 25.44KB/s]WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

  0%|          | 284/18883655 [00:13<197:40:49, 26.53KB/s]  0%|          | 291/18883655 [00:13<191:54:17, 27.33KB/s]  0%|          | 294/18883655 [00:14<289:14:59, 18.13KB/s]  0%|          | 307/18883655 [00:14<193:23:23, 27.12KB/s]WARNING: Detect dataset only contains single fileds, return format changed since Paddle 2.1. In Paddle <= 2.0, DataLoader add a list surround output data(e.g. return [data]), and in Paddle >= 2.1, DataLoader return the single filed directly (e.g. return data). For example, in following code: 

import numpy as np
from paddle.io import DataLoader, Dataset

class RandomDataset(Dataset):
    def __getitem__(self, idx):
        data = np.random.random((2, 3)).astype('float32')

        return data

    def __len__(self):
        return 10

dataset = RandomDataset()
loader = DataLoader(dataset, batch_size=1)
data = next(loader())

In Paddle <= 2.0, data is in format '[Tensor(shape=(1, 2, 3), dtype=float32)]', and in Paddle >= 2.1, data is in format 'Tensor(shape=(1, 2, 3), dtype=float32)'

  0%|          | 311/18883655 [00:14<269:31:20, 19.46KB/s]  0%|          | 321/18883655 [00:14<213:11:22, 24.60KB/s]  0%|          | 324/18883655 [00:15<304:21:44, 17.23KB/s]  0%|          | 327/18883655 [00:15<323:44:36, 16.20KB/s]  0%|          | 331/18883655 [00:15<321:11:09, 16.33KB/s]  0%|          | 333/18883655 [00:16<646:31:06,  8.11KB/s]  0%|          | 335/18883655 [00:17<846:03:06,  6.20KB/s]  0%|          | 340/18883655 [00:17<616:57:05,  8.50KB/s]  0%|          | 343/18883655 [00:18<567:43:50,  9.24KB/s]  0%|          | 346/18883655 [00:18<532:04:47,  9.86KB/s]  0%|          | 349/18883655 [00:18<501:04:28, 10.47KB/s]

--------------------------------------
C++ Traceback (most recent call last):
--------------------------------------
0   paddle::framework::SignalHandle(char const*, int)
1   paddle::platform::GetCurrentTraceBackString[abi:cxx11]()

----------------------
Error Message Summary:
----------------------
FatalError: `Termination signal` is detected by the operating system.
  [TimeInfo: *** Aborted at 1628481837 (unix time) try "date -d @1628481837" if you are using GNU date ***]
  [SignalInfo: *** SIGTERM (@0x3760) received by PID 14247 (TID 0x7fe83f170740) from PID 14176 ***]

